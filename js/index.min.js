var mainW=$(".content").width(),fbinApp=!1,official_website="http://www.vivo.com/tw/products/nex2?fromBanner=Home_top_bigBanner",FB_site="https://www.facebook.com/vivotaiwan/",dataInfo={name:"",mobile:"",email:"",i_no:0},arr=[1,2,3,4,1,2,3,4],newArr=[],pick=[],result,match=0,FB_shareIMG="",FB_shareLink="",timer,sec=0,minute=0,hour=0,show_time,show_minute,show_sec;function game_init(){arr=[1,2,3,4,1,2,3,4],newArr=[],index=0,sec=0,minute=0,hour=0,match=0,cardH=250*mainW/640,clearInterval(timer),$(".complete").hide(),$(".time").html("00:00"),$(".playground").children().remove()}function game_start(){for(i=0;i<arr.length;i++)randomSort(arr,newArr);console.log(newArr),setTimeout(function(){$(".card").addClass("delay")},100),setTimeout(function(){$(".card").css("opacity","1").removeClass("delay"),$(".card").removeClass("pick"),setTimeout(function(){$(".go").addClass("act"),setTimeout(function(){$(".go").removeClass("act"),timer=setInterval(checkTime,1e3)},2e3)},500)},2e3),$(".card").on("touchstart",function(){pick.length<2&&!$(this).hasClass("pick")&&($(this).addClass("pick"),pick.push($(this).attr("data")),2==pick.length&&pick[0]==pick[1]?(result=pick[0],pick=[],$(".pick").each(function(){$(this).hasClass("check")||$(this).addClass("check")}),score()):2==pick.length&&pick[0]!=pick[1]&&setTimeout(function(){$(".card").each(function(){$(this).hasClass("check")||$(this).removeClass("pick")}),pick=[]},1e3))})}function randomSort(arr,newArr){if(1==arr.length)return newArr.push(arr[0]),$(".playground").append('<div class="card pick" style="height:'+cardH+'px" data="'+arr[0]+'"><div><img src="img/game_'+arr[0]+'.png"></div></div>'),newArr;var random=Math.ceil(Math.random()*arr.length)-1;return newArr.push(arr[random]),index++,$(".playground").append('<div class="card pick" style="height:'+cardH+'px" data="'+arr[random]+'"><div><img src="img/game_'+arr[random]+'.png"></div></div>'),arr.splice(random,1),randomSort(arr,newArr)}function score(){if(match++,show_Match(),console.log("match:"+match),4==match){setTimeout(function(){$(".complete").fadeIn(300)},3700),clearInterval(timer),console.log(show_time);var $request=$.ajax({url:"func.php",type:"POST",data:{func:"makeImg",time:show_time},timeout:3e4,dataType:"json"}).done(function(data){1===toNumber(data.ok)?(FB_shareIMG="https://wwwosc.ad2iction.com/18/vivo/post/"+data.imgNo+".png",FB_shareLink="https://wwwosc.ad2iction.com/18/vivo/share.php?num="+data.imgNo,setTimeout(function(){GEvent("Game","遊戲完成進入結果頁"),$(".game").hide(),$(".result,header").fadeIn(500)},4300)):alert("完成時間沒有填寫")})}}function show_Match(){$(".match>div").hide(),$(".match>div:nth-child("+result+")").show(),setTimeout(function(){$(".match").fadeIn(300),$(".content").toggleClass("blur"),$(".menu").hasClass("open")?$(".menu").fadeIn(500):$(".menu").fadeOut(500)},500),setTimeout(function(){$(".match").fadeOut(300),$(".content").toggleClass("blur"),$(".menu").hasClass("open")?$(".menu").fadeIn(500):$(".menu").fadeOut(500)},3500)}function toNumber(strNumber){return+strNumber}function checkTime(){sec++,second=Math.floor(Math.floor(sec%60)),minute=Math.floor(Math.floor(sec/60)),show_sec=second<10?"0"+second:second,show_time=(show_minute=minute<10?"0"+minute:minute)+":"+show_sec,$(".time").html(show_time),minute>59&&location.href("index.html")}function checkdata(name,phone,mail){var mailfrom=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,phonefrom=/09[0-9]{8}/;if(""===name)return alert("請輸入名字"),!1;if(phonefrom.test(phone)){if(mailfrom.test(mail)){if(!0!==$("#inn")[0].checked)return alert("請勾選同意送出個人資料"),!1;var $request=$.ajax({url:"func.php",type:"POST",data:{func:"submit",data:dataInfo},timeout:3e4,dataType:"json"}).done(function(data){1===toNumber(data.ok)?(GEvent("表單","表單送出"),alert("成功送出"),$("input").val(""),$(".form").hide(),$(".result").show()):alert("有欄位沒填, 或有問題 ==> "+data.fields)});return!0}return alert("E-mail格式有誤"),!1}return alert("手機格式有誤"),!1}function intro(){$(".line").css("height",234*mainW/640),$(".pathR img,.pathL img").css("width",mainW),$(".nex img,.intro .title img,.kv img,.slogan li,.intro .play img").addClass("act"),setTimeout(function(){$(".pathR,.pathL").addClass("act")},1e3)}function menu(){$(".menu").toggleClass("open"),$(".content,header").toggleClass("blur"),$(".menu").hasClass("open")?$(".menu").fadeIn(500):$(".menu").fadeOut(500)}!function($){$(".skip").click(function(){$(".game").hide(),$(".result,header").fadeIn(500)}),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(GEvent("進入網站","進入網站_行動裝置"),/fb|line/i.test(navigator.userAgent)?(fbinApp=!0,$(".inapp").show()):($(".intro,header").show(),$(window).on("load",function(){$(".loading").fadeOut(300),intro()}),$(".ham,.menu_close").click(function(){menu()}),$(".menu li").click(function(){switch($(this).index()){case 0:GEvent("menu","menu_回首頁"),location.href="index.html";break;case 1:GEvent("menu","menu_活動辦法"),$(".rule").fadeIn(300);break;case 2:GEvent("menu","menu_得獎名單"),$(".winner").fadeIn(300);break;case 3:GEvent("menu","menu_粉絲團"),1==fbinApp?location.href=FB_site:window.open(FB_site,"_blank");break;case 4:GEvent("menu","menu_官網"),1==fbinApp?location.href=official_website:window.open(official_website,"_blank")}menu()}),$(".go_rule").click(function(){$(".rule").fadeIn(300),GEvent("表單頁","表單_活動辦法")}),$(".rule_close,.winner_close").click(function(){$(".rule,.winner").fadeOut(300)}),$(".play").click(function(){GEvent("首頁","首頁_立即挑戰"),$(".tips").fadeIn(500),$(".content,header").addClass("blur")}),$(".start,.go_play").on("click",function(){$(this).hasClass("start")?GEvent("遊戲說明","遊戲說明_立即挑戰"):GEvent("結果頁","再玩一次"),$(".tips,.intro,.result,header").hide(),game_init(),$(".game").fadeIn(500),$(".content,header").removeClass("blur"),setTimeout(function(){game_start()},500)}),$(".go_form").click(function(){GEvent("結果頁","參加抽獎"),$(".result").hide(),$(".form").fadeIn(500)}),$(".go_web").click(function(){GEvent("結果頁","結果頁_前往官網"),window.open(official_website,"_blank")}),$(".fb").on("click",function(event){GEvent("結果頁","FB分享"),event.preventDefault(),event.stopImmediatePropagation();var FBDesc="翻轉未來！挑戰雙螢記憶翻牌抽vivo NEX雙螢幕及多項好禮！",FBTitle="vivo NEX雙螢幕版 未來不止一面",FBLink=FB_shareLink,FBPic=FB_shareIMG;FB.ui({method:"share",href:FBLink})}),$("#SUD_Bu_Submit").on("click",function(){dataInfo.name=$("#SUD_Name").val(),dataInfo.mobile=$("#SUD_Mobile").val(),dataInfo.email=$("#SUD_EMail").val(),checkdata(dataInfo.name,dataInfo.mobile,dataInfo.email)}))):(GEvent("進入網站","PC"),$(".pc").show())}(jQuery);